# üê≥ DigitalOcean App Specification

This is an auto-generated app spec for DigitalOcean App Platform.
You can use this to deploy via CLI or import into the UI.

## Using This File

### Option 1: CLI Deployment (Advanced)

```bash
# Install doctl (DigitalOcean CLI)
# See: https://docs.digitalocean.com/reference/doctl/how-to/install/

# Authenticate
doctl auth init

# Create app from spec
doctl apps create --spec .do/app.yaml

# Or update existing app
doctl apps update YOUR_APP_ID --spec .do/app.yaml
```

### Option 2: UI Import

1. Go to https://cloud.digitalocean.com/apps
2. Click "Create App"
3. Select "Import from spec file"
4. Upload this file

---

## App Specification

```yaml
name: job-scraper-api
region: nyc
services:
  - name: api
    # Docker configuration
    dockerfile_path: Dockerfile
    source_dir: /
    
    # GitHub integration (update with your repo)
    github:
      repo: YOUR_USERNAME/YOUR_REPO_NAME
      branch: main
      deploy_on_push: true
    
    # Resource allocation
    instance_count: 1
    instance_size_slug: basic-xxs  # $5/month - 512MB RAM
    # Upgrade options:
    # - basic-xs: $10/month - 1GB RAM
    # - professional-xs: $12/month - 1GB RAM + better SLA
    
    # HTTP configuration
    http_port: 8080
    
    # Environment variables
    envs:
      - key: PORT
        value: "8080"
      - key: DEBUG
        value: "False"
      - key: HEADLESS_MODE
        value: "True"
      - key: PLAYWRIGHT_BROWSERS_PATH
        value: "/ms-playwright"
      - key: LOG_LEVEL
        value: "INFO"
      - key: MAX_PAGES_PER_KEYWORD
        value: "3"
      - key: MAX_JOBS_GLASSDOOR
        value: "20"
      - key: DEFAULT_LOCATION
        value: "United States"
      - key: GUNICORN_WORKERS
        value: "1"
      - key: GUNICORN_THREADS
        value: "2"
      - key: GUNICORN_TIMEOUT
        value: "600"
      - key: DIGITALOCEAN
        value: "true"
    
    # Health check configuration
    health_check:
      http_path: /health
      initial_delay_seconds: 60
      period_seconds: 30
      timeout_seconds: 10
      success_threshold: 1
      failure_threshold: 3
    
    # Routes
    routes:
      - path: /

# Optional: Add databases or other services here
# databases:
#   - name: db
#     engine: PG
#     version: "15"
```

---

## Customization

### Update Repository Information

Replace in the spec above:
```yaml
github:
  repo: YOUR_USERNAME/YOUR_REPO_NAME
  branch: main
```

With your actual GitHub repository information.

### For GitLab or Bitbucket

```yaml
gitlab:
  repo: YOUR_USERNAME/YOUR_REPO_NAME
  branch: main
```

Or:

```yaml
bitbucket:
  repo: YOUR_USERNAME/YOUR_REPO_NAME
  branch: main
```

### Upgrade Instance Size

For better performance, upgrade the instance:

```yaml
instance_size_slug: professional-xs  # $12/month - 1GB RAM
```

Available sizes:
- `basic-xxs`: $5/month - 512MB RAM
- `basic-xs`: $10/month - 1GB RAM  
- `professional-xs`: $12/month - 1GB RAM (better SLA)
- `professional-s`: $24/month - 2GB RAM

### Enable Auto-Scaling (Professional tier only)

```yaml
instance_count: 1
autoscaling:
  min_instance_count: 1
  max_instance_count: 3
  metrics:
    cpu:
      percent: 80
```

---

## Notes

- Health check waits 60 seconds before first check (browser installation)
- Timeout set to 600 seconds (10 minutes) for long scraping operations
- Single worker to minimize memory usage on basic plan
- All sensitive data should go in environment variables, not in code

---

For more information, see `DIGITALOCEAN_DEPLOYMENT.md`
